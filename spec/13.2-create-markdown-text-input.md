# Spec 13.2: Create Markdown via Text Input

**Status:** Complete
**Created:** 2025-12-01
**Parent:** [Spec 13: Lightweight Knowledge Base](13-lightweight-knowledge-base.md)

## Overview

Allow users to create a new markdown document by entering a title and pasting/typing content into a large text area.

## Requirements

### Functional Requirements

1. **New Document Button**
   - Add "+ New Document" button on KB page
   - Links to `/kb/new` route

2. **Form Fields**
   - Title input (required)
   - Content textarea (required, large for pasting markdown)

3. **Form Behavior**
   - Submit saves document to database
   - Redirect to KB list on success
   - Show validation errors for empty fields

### Technical Requirements

1. **Route** - `/kb/new` using Next.js App Router
2. **Client Component** - For form interactivity
3. **API** - Use Amplify client to create KBDocument

## Implementation Plan

### Files to Create

1. **src/app/kb/new/page.tsx** - New document form

### Files to Modify

1. **src/app/kb/page.tsx** - Add "+ New Document" button

## Test Cases

### Cypress E2E Tests

**Test 1: New Document Link**
```typescript
it("has a link to create new document", () => {
  cy.visit("/kb");
  cy.contains("a", "+ New Document").click();
  cy.url().should("include", "/kb/new");
});
```

**Test 2: Form Fields Exist**
```typescript
it("displays title and content fields", () => {
  cy.visit("/kb/new");
  cy.get('[name="title"]').should("exist");
  cy.get('[name="content"]').should("exist");
});
```

**Test 3: Title Required**
```typescript
it("shows error when title is empty", () => {
  cy.visit("/kb/new");
  cy.get('[name="content"]').type("Some content");
  cy.get('button[type="submit"]').click();
  cy.get('[data-testid="title-error"]').should("exist");
});
```

**Test 4: Content Required**
```typescript
it("shows error when content is empty", () => {
  cy.visit("/kb/new");
  cy.get('[name="title"]').type("Test Title");
  cy.get('button[type="submit"]').click();
  cy.get('[data-testid="content-error"]').should("exist");
});
```

**Test 5: Successful Creation**
```typescript
it("creates document and redirects to KB list", () => {
  cy.visit("/kb/new");
  cy.get('[name="title"]').type("Test Document");
  cy.get('[name="content"]').type("# Test Markdown\\n\\nThis is content.");
  cy.get('button[type="submit"]').click();
  cy.url().should("eq", Cypress.config().baseUrl + "/kb");
});
```

## UI Design

```
┌─────────────────────────────────────────────────────────────┐
│  Idea Backlog    Knowledge Base                             │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  Add New Document                                           │
│                                                             │
│  Title                                                      │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                                                     │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  Content                                                    │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                                                     │   │
│  │                                                     │   │
│  │                                                     │   │
│  │                                                     │   │
│  │                                                     │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  [ Add Document ]                                           │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```
